{% extends "layout.html" %}

{%block head%}
<title>Scan Result</title>
<style>
    table {
      font-family: arial, sans-serif;
      border-collapse: collapse;
      width: 85%;
    }
    
    td, th {
      border: 1px solid black;
      text-align: left;
      padding: 8px;
    }
    
    tr:nth-child(even) {
      background-color: white;
    }
    </style>
{%endblock%}

{% block body %}
<div  style="background-color: #f76c6c;">
    <p>{{report.summary}}  |  Nmap version: {{report.version}} </p>
    <p>Command: {{report.commandline}}  |  Scan Type: {{report.scan_type}}</p>
    <div style="height: 83%; width: 100%; background-color: orange; float: bottom; position: absolute; margin-right: 10px;
     margin-right: 5px;">

        <!--search box div---------------------------------------------------------------------------------------->
        <div style="height: 50%; width: 30%; background-color: #a8d0e6; float: left; overflow: scroll;border: 2px solid #f76c6c;
        text-align: center; ">
            
            <p>Search Scan</p>
            <form action="/buy" method="post" style="width: 50%; margin: 0 auto; margin-top: 10%;" >
                <div class="form-group">
                    <input autocomplete="off" autofocus class="form-control" name="symbol" placeholder="host ip" type="text"/>
                </div>
                
                <button class="btn btn-primary" type="submit">Search</button>
            </form>

            <form action="/buy" method="post" style="width: 50%; padding-top: 20px; margin: 0 auto" >
                <div class="form-group">
                    <input autocomplete="off" autofocus class="form-control" name="symbol" placeholder="port no." type="text"/>
                </div>
                
                <button class="btn btn-primary" type="submit">Search</button>
            </form>
        </div>
        <!--search box div------------------------------------------------------------------------------------------>

        <!-- device types  div-------------------------------------------------------------------------------------->
        <div style="height: 50%; width: 20%; background-color: #a8d0e6; float: left; overflow: scroll;
        border: 2px solid #f76c6c;">
            <p style="text-align: center;"> Device Types</p>
            {% for device in devices %}
                {{device}}<br>
            {% endfor %}
        </div>
        <!-- device types  div-------------------------------------------------------------------------------------->

        

        <!-- distinct ports open  div-------------------------------------------------------------------------------------->
        <div style="height: 50%; width: 25%; background-color: #a8d0e6; float: left; overflow: scroll; text-align: center;
        border: 2px solid #f76c6c;">
            <p>Ports Open</p>
            {%for p in ports%}
            <form action="/scanresult/1/{{file}}" method="POST">
                <input type="submit" name="port_submit" value={{p}} style="background-color: lightblue;
                border-width: 0px;">
            </form>
            {%endfor%}
        </div>
        <!-- distinct ports open  div-------------------------------------------------------------------------------------->

        <!--hosts with particular port open  div-------------------------------------------------------------------------------------->
        <div style="height: 50%; width: 25%; background-color: #a8d0e6; float: left; overflow: scroll; text-align: center;
        border: 2px solid #f76c6c;">
            <p>hosts with port {{port}} open</p>
                {% for ips in ips_with_port %}
                    <form action="/scanresult/1/{{file}}" method="POST">
                        <input type="submit" name="ip_submit" value={{ips}} style="background-color: lightblue;
                        border-width: 0px;">
                    </form>
                {% endfor %}
            
        </div>
        <!--hosts with particular port open  div-------------------------------------------------------------------------------------->

        <!-- distinct products  div-------------------------------------------------------------------------------------->
        <div style="height: 50% ;width: 50%; background-color: #a8d0e6; float: left; overflow: scroll; 
        border: 2px solid #f76c6c;  padding-left: 5px;">
            <p>Products Detected</p>
            {%for p in products%}
                {{p}}
                <br>
            {%endfor%}
        </div>
        <!-- distinct products  div-------------------------------------------------------------------------------------->

         <!-- up hosts  div-------------------------------------------------------------------------------------->
         <div style="height: 50%; width: 15%; background-color: #a8d0e6; float: left; overflow: scroll; text-align: center;
         border: 2px solid #f76c6c;">
             <p>Up Hosts</p>
             {% for h in report.hosts %}
                 {%if h.is_up()%}
                     <form action="/scanresult/1/{{file}}" method="POST">
                         <input type="submit" name="ip_submit" value={{h.ipv4}} style="background-color: lightblue;
                         border-width: 0px;">
                     </form>
                     
                 {%endif%}
             {%endfor%}
         </div>
         <!-- up hosts  div-------------------------------------------------------------------------------------->
 

        <!-- host info  div-------------------------------------------------------------------------------------->
        <div style="height: 50% ;width: 35%; background-color: #a8d0e6; float: left; overflow: scroll; 
        border: 2px solid #f76c6c; padding-left: 5px;">
            <p style="text-align: center;">Host Details ({{host.ipv4}})</p>
                <!-- write code to hande the case when no host is up initially -->
                IP Address: {{host.ipv4}}<br>
                MAC address: {{host.mac}} ({{host.vendor}})<br>
                Distance: {{host.distance}} hops<br>
                {% if host.os_match_probabilities() | length >=1 %}
                    OS: {{host.os_match_probabilities()[0].name}} ({{host.os_match_probabilities()[0].accuracy}}%)<br>
                    Device Type: {{host.os_class_probabilities()[0].description}}<br>
                    
                {% endif %}
                
                <table>
                    <tr>
                        <th>
                            Port
                        </th>
                        <th>
                            State
                        </th>
                        <th>
                            Service
                        </th>
                        <th>
                            Version
                        </th>
                    </tr>
                    {% for touple in host.get_ports(): %}
                        <tr>
                            <td>
                                {{touple[0]}}/{{touple[1]}}
                            </td>
                            <td>
                                {% set s=host.get_service(touple[0],touple[1])%}
                                {{s.state}}
                                
                                
                            </td>
                            <td>
                                {{s.service}}
                                
                            </td>
                            <td>
                                {{s.banner}}
                            </td>

                        </tr>
                    {% endfor %}
                </table>
                <br> 
        </div>
        <!-- host info  div-------------------------------------------------------------------------------------->
        
        
    </div>
</div>
{% endblock body %}