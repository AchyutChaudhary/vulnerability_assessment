from flask import Flask, redirect, render_template, request
from os import listdir                                      # to find all files in a directory (specifically scans directory)
from flask import Blueprint
import json

allscans_route = Blueprint('allscans_route', __name__)
@allscans_route.route('/allscans')
def allscans():

    # fetching list of all files in scans directory to display on the website
    #                  change directory as per requirement
    result = listdir('/Users/achalsaharan/capweb/scans')

    # appending all .xml files in files list, important step because the OS add other files containing folder meta data sometimes
    files = []
    for i in range(len(result)):
        if (result[i][-4:] == ".xml" ):
            files.append(result[i])

    #removing the .xml at the end of each file to pass to the template
    for i in range(len(files)):
        files[i] = files[i][:-4]
    
    josn_obj = json.dumps(files)
    return josn_obj
    

    return render_template('allscans.html', files=files)
